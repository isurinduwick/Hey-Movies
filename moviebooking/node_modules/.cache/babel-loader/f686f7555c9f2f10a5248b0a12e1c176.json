{"ast":null,"code":"var _jsxFileName = \"D:\\\\EAD-CW\\\\moviebooking\\\\src\\\\Components\\\\RegPopup\\\\LoginPopup.jsx\";\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport './LoginPopup.css';\nimport { loginUser } from '../../api';\nconst LoginPopup = ({\n  onClose,\n  onSwitchToRegister\n}) => {\n  const popupRef = useRef(null);\n  const [formData, setFormData] = useState({\n    username: '',\n    password: ''\n  });\n  const [errors, setErrors] = useState({});\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (popupRef.current && !popupRef.current.contains(event.target)) {\n        if (onClose) {\n          onClose();\n        }\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [onClose]);\n  useEffect(() => {\n    // Retrieve onClose from location state if available\n    if (location.state && location.state.onClose) {\n      setOnClose(() => location.state.onClose);\n    }\n  }, [location.state]);\n  const handleChange = event => {\n    const {\n      name,\n      value\n    } = event.target;\n    setFormData({\n      ...formData,\n      [name]: value\n    });\n    setErrors(prevErrors => ({\n      ...prevErrors,\n      [name]: ''\n    }));\n  };\n  const validateForm = () => {\n    const newErrors = {};\n    if (!formData.username.trim()) {\n      newErrors.username = 'Username is required';\n    }\n    if (!formData.password) {\n      newErrors.password = 'Password is required';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n  const handleSubmit = async event => {\n    event.preventDefault();\n    if (!validateForm()) return;\n    setLoading(true);\n    try {\n      const userData = await loginUser(formData);\n      if (userData && userData.name) {\n        localStorage.setItem('token', userData.token);\n        localStorage.setItem('username', userData.username);\n        alert(`Welcome, ${userData.name}!`);\n        onClose(); // Call onClose if defined\n        navigate('/welcome');\n      } else {\n        setErrors({\n          general: 'Unexpected response format. Please try again.'\n        });\n      }\n    } catch (err) {\n      console.error('Login error:', err);\n      setErrors({\n        general: err.message || 'Login failed. Please check your username and password.'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    ref: popupRef,\n    className: \"login-popup-container\",\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup-inputs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"username\",\n    type: \"text\",\n    placeholder: \"Username\",\n    value: formData.username,\n    onChange: handleChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 11\n    }\n  }), errors.username && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 31\n    }\n  }, errors.username), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"password\",\n    type: \"password\",\n    placeholder: \"Password\",\n    value: formData.password,\n    onChange: handleChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 11\n    }\n  }), errors.password && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 31\n    }\n  }, errors.password)), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 9\n    }\n  }, loading ? 'Logging in...' : 'Login'), errors.general && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 28\n    }\n  }, errors.general), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup-condition\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 11\n    }\n  }, \"By Continuing, I agree to the terms of use & privacy policy. \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 74\n    }\n  }), \"If you don't have an account, \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    onClick: onSwitchToRegister,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 43\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 84\n    }\n  }, \"Click Here\")), \" to Register.\"))));\n};\nexport default LoginPopup;","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","useLocation","loginUser","LoginPopup","onClose","onSwitchToRegister","popupRef","formData","setFormData","username","password","errors","setErrors","loading","setLoading","navigate","location","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","state","setOnClose","handleChange","name","value","prevErrors","validateForm","newErrors","trim","Object","keys","length","handleSubmit","preventDefault","userData","localStorage","setItem","token","alert","general","err","console","error","message","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","onSubmit","type","placeholder","onChange","required","disabled","href","onClick"],"sources":["D:/EAD-CW/moviebooking/src/Components/RegPopup/LoginPopup.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\nimport './LoginPopup.css';\r\nimport { loginUser } from '../../api'; \r\n\r\nconst LoginPopup = ({ onClose, onSwitchToRegister }) => {\r\n  const popupRef = useRef(null);\r\n  const [formData, setFormData] = useState({\r\n    username: '',\r\n    password: ''\r\n  });\r\n  const [errors, setErrors] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (popupRef.current && !popupRef.current.contains(event.target)) {\r\n        if (onClose) {\r\n          onClose();\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [onClose]);\r\n\r\n  useEffect(() => {\r\n    // Retrieve onClose from location state if available\r\n    if (location.state && location.state.onClose) {\r\n      setOnClose(() => location.state.onClose);\r\n    }\r\n  }, [location.state]);\r\n\r\n  const handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    setFormData({ ...formData, [name]: value });\r\n    setErrors(prevErrors => ({ ...prevErrors, [name]: '' }));\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const newErrors = {};\r\n    if (!formData.username.trim()) {\r\n      newErrors.username = 'Username is required';\r\n    }\r\n    if (!formData.password) {\r\n      newErrors.password = 'Password is required';\r\n    }\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    if (!validateForm()) return;\r\n\r\n    setLoading(true);\r\n    try {\r\n      const userData = await loginUser(formData);\r\n      if (userData && userData.name) {\r\n        localStorage.setItem('token', userData.token);\r\n        localStorage.setItem('username', userData.username);\r\n        alert(`Welcome, ${userData.name}!`);\r\n        onClose(); // Call onClose if defined\r\n        navigate('/welcome');\r\n      } else {\r\n        setErrors({ general: 'Unexpected response format. Please try again.' });\r\n      }\r\n    } catch (err) {\r\n      console.error('Login error:', err);\r\n      setErrors({ general: err.message || 'Login failed. Please check your username and password.' });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login-popup\">\r\n      <form ref={popupRef} className=\"login-popup-container\" onSubmit={handleSubmit}>\r\n        <div className=\"login-popup-inputs\">\r\n          <input name=\"username\" type=\"text\" placeholder=\"Username\" value={formData.username} onChange={handleChange} required />\r\n          {errors.username && <span className=\"error\">{errors.username}</span>}\r\n          <input name=\"password\" type=\"password\" placeholder=\"Password\" value={formData.password} onChange={handleChange} required />\r\n          {errors.password && <span className=\"error\">{errors.password}</span>}\r\n        </div>\r\n        <button type=\"submit\" disabled={loading}>\r\n          {loading ? 'Logging in...' : 'Login'}\r\n        </button>\r\n\r\n        {errors.general && <p className=\"error\">{errors.general}</p>}\r\n\r\n        <div className=\"login-popup-condition\">\r\n          <input type=\"checkbox\" required />\r\n          <p>\r\n            By Continuing, I agree to the terms of use & privacy policy. <br />\r\n            If you don't have an account, <a href=\"#\" onClick={onSwitchToRegister}><b>Click Here</b></a> to Register.\r\n          </p>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginPopup;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
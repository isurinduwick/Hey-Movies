{"ast":null,"code":"var _jsxFileName = \"D:\\\\EAD-CW\\\\moviebooking\\\\src\\\\Components\\\\RegPopup\\\\LoginPopup.jsx\";\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './LoginPopup.css';\nimport { loginUser } from '../../api'; // Adjust the import path if needed\n\nconst LoginPopup = ({\n  onClose,\n  onSwitchToRegister\n}) => {\n  const popupRef = useRef(null);\n  const [formData, setFormData] = useState({\n    username: '',\n    password: ''\n  });\n  const [error, setError] = useState('');\n  const navigate = useNavigate(); // Updated for navigation\n\n  const handleClickOutside = event => {\n    if (popupRef.current && !popupRef.current.contains(event.target)) {\n      onClose();\n    }\n  };\n  useEffect(() => {\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [handleClickOutside]);\n  const handleChange = event => {\n    const {\n      name,\n      value\n    } = event.target;\n    setFormData({\n      ...formData,\n      [name]: value\n    });\n  };\n  const handleSubmit = async event => {\n    event.preventDefault();\n    setError(''); // Clear any previous errors\n    try {\n      console.log('Sending login request with:', formData);\n      const userData = await loginUser(formData); // Get the response\n      console.log('Received user data:', userData);\n      if (userData && userData.name) {\n        // Store user data in localStorage\n        localStorage.setItem('user', JSON.stringify(userData));\n        alert(`Welcome, ${userData.name}!`); // Display the success message\n        onClose(); // Close the login popup\n        navigate('/welcome'); // Navigate to the welcome page or desired route\n      } else {\n        setError('Unexpected response format. Please try again.');\n      }\n    } catch (err) {\n      console.error('Login error:', err);\n      setError(err.message || 'Login failed. Please check your username and password.');\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    ref: popupRef,\n    className: \"login-popup-container\",\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup-inputs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"username\",\n    type: \"text\",\n    placeholder: \"Username\",\n    value: formData.username,\n    onChange: handleChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"password\",\n    type: \"password\",\n    placeholder: \"Password\",\n    value: formData.password,\n    onChange: handleChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 9\n    }\n  }, \"Login\"), error && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 19\n    }\n  }, error), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup-condition\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 11\n    }\n  }, \"By Continuing, I agree to the terms of use & privacy policy. \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 74\n    }\n  }), \"If you don't have an account, \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    onClick: onSwitchToRegister,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 43\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 84\n    }\n  }, \"Click Here\")), \" to Register.\"))));\n};\nexport default LoginPopup;","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","loginUser","LoginPopup","onClose","onSwitchToRegister","popupRef","formData","setFormData","username","password","error","setError","navigate","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleChange","name","value","handleSubmit","preventDefault","console","log","userData","localStorage","setItem","JSON","stringify","alert","err","message","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","onSubmit","type","placeholder","onChange","required","href","onClick"],"sources":["D:/EAD-CW/moviebooking/src/Components/RegPopup/LoginPopup.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './LoginPopup.css';\r\nimport { loginUser } from '../../api';  // Adjust the import path if needed\r\n\r\nconst LoginPopup = ({ onClose, onSwitchToRegister }) => {\r\n  const popupRef = useRef(null);\r\n  const [formData, setFormData] = useState({\r\n    username: '',\r\n    password: ''\r\n  });\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate(); // Updated for navigation\r\n\r\n  const handleClickOutside = (event) => {\r\n    if (popupRef.current && !popupRef.current.contains(event.target)) {\r\n      onClose();\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [handleClickOutside]);\r\n\r\n  const handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    setError('');  // Clear any previous errors\r\n    try {\r\n        console.log('Sending login request with:', formData);\r\n        const userData = await loginUser(formData);  // Get the response\r\n        console.log('Received user data:', userData);\r\n\r\n        if (userData && userData.name) {\r\n            // Store user data in localStorage\r\n            localStorage.setItem('user', JSON.stringify(userData));\r\n            alert(`Welcome, ${userData.name}!`);  // Display the success message\r\n            onClose();  // Close the login popup\r\n            navigate('/welcome');  // Navigate to the welcome page or desired route\r\n        } else {\r\n            setError('Unexpected response format. Please try again.');\r\n        }\r\n    } catch (err) {\r\n        console.error('Login error:', err);\r\n        setError(err.message || 'Login failed. Please check your username and password.');\r\n    }\r\n};\r\n  \r\n  \r\n\r\n  return (\r\n    <div className=\"login-popup\">\r\n      <form ref={popupRef} className=\"login-popup-container\" onSubmit={handleSubmit}>\r\n        <div className=\"login-popup-inputs\">\r\n          <input name=\"username\" type=\"text\" placeholder=\"Username\" value={formData.username} onChange={handleChange} required />\r\n          <input name=\"password\" type=\"password\" placeholder=\"Password\" value={formData.password} onChange={handleChange} required />\r\n        </div>\r\n        <button type=\"submit\">Login</button>\r\n\r\n        {error && <p className=\"error\">{error}</p>}\r\n\r\n        <div className=\"login-popup-condition\">\r\n          <input type=\"checkbox\" required />\r\n          <p>\r\n            By Continuing, I agree to the terms of use & privacy policy. <br />\r\n            If you don't have an account, <a href=\"#\" onClick={onSwitchToRegister}><b>Click Here</b></a> to Register.\r\n          </p>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginPopup;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"var _jsxFileName = \"D:\\\\EAD-CW\\\\moviebooking\\\\src\\\\Components\\\\RegPopup\\\\LoginPopup.jsx\";\nimport React, { useState, useRef, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport './LoginPopup.css';\nimport { loginUser } from '../../api';\nconst LoginPopup = ({\n  onClose,\n  onSwitchToRegister\n}) => {\n  const popupRef = useRef(null);\n  const [formData, setFormData] = useState({\n    username: '',\n    password: ''\n  });\n  const [errors, setErrors] = useState({});\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n  useEffect(() => {\n    const handleClickOutside = event => {\n      if (popupRef.current && !popupRef.current.contains(event.target)) {\n        onClose();\n      }\n    };\n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, [onClose]);\n  const handleChange = event => {\n    const {\n      name,\n      value\n    } = event.target;\n    setFormData({\n      ...formData,\n      [name]: value\n    });\n    setErrors(prevErrors => ({\n      ...prevErrors,\n      [name]: ''\n    }));\n  };\n  const validateForm = () => {\n    const newErrors = {};\n    if (!formData.username.trim()) {\n      newErrors.username = 'Username is required';\n    }\n    if (!formData.password) {\n      newErrors.password = 'Password is required';\n    }\n    setErrors(newErrors);\n    return Object.keys(newErrors).length === 0;\n  };\n  const handleSubmit = async event => {\n    event.preventDefault();\n    if (!validateForm()) return;\n    setLoading(true);\n    try {\n      const userData = await loginUser(formData); // Assuming loginUser returns JSON data directly\n      if (userData.token && userData.username) {\n        localStorage.setItem('token', userData.token);\n        localStorage.setItem('username', userData.username);\n        alert(`Welcome, ${userData.username}!`);\n        onClose();\n        navigate('/welcome');\n      } else {\n        setErrors({\n          general: 'Unexpected response format. Please try again.'\n        });\n      }\n    } catch (err) {\n      console.error('Login error:', err);\n      setErrors({\n        general: err.message || 'Login failed. Please check your username and password.'\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"form\", {\n    ref: popupRef,\n    className: \"login-popup-container\",\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup-inputs\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    name: \"username\",\n    type: \"text\",\n    placeholder: \"Username\",\n    value: formData.username,\n    onChange: handleChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 11\n    }\n  }), errors.username && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 31\n    }\n  }, errors.username), /*#__PURE__*/React.createElement(\"input\", {\n    name: \"password\",\n    type: \"password\",\n    placeholder: \"Password\",\n    value: formData.password,\n    onChange: handleChange,\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  }), errors.password && /*#__PURE__*/React.createElement(\"span\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 31\n    }\n  }, errors.password)), /*#__PURE__*/React.createElement(\"button\", {\n    type: \"submit\",\n    disabled: loading,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 9\n    }\n  }, loading ? 'Logging in...' : 'Login'), errors.general && /*#__PURE__*/React.createElement(\"p\", {\n    className: \"error\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 28\n    }\n  }, errors.general), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"login-popup-condition\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"checkbox\",\n    required: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }\n  }, \"By Continuing, I agree to the terms of use & privacy policy. \", /*#__PURE__*/React.createElement(\"br\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 74\n    }\n  }), \"If you don't have an account, \", /*#__PURE__*/React.createElement(\"a\", {\n    href: \"#\",\n    onClick: onSwitchToRegister,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 43\n    }\n  }, /*#__PURE__*/React.createElement(\"b\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 84\n    }\n  }, \"Click Here\")), \" to Register.\"))));\n};\nexport default LoginPopup;","map":{"version":3,"names":["React","useState","useRef","useEffect","useNavigate","loginUser","LoginPopup","onClose","onSwitchToRegister","popupRef","formData","setFormData","username","password","errors","setErrors","loading","setLoading","navigate","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","handleChange","name","value","prevErrors","validateForm","newErrors","trim","Object","keys","length","handleSubmit","preventDefault","userData","token","localStorage","setItem","alert","general","err","console","error","message","createElement","className","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","ref","onSubmit","type","placeholder","onChange","required","disabled","href","onClick"],"sources":["D:/EAD-CW/moviebooking/src/Components/RegPopup/LoginPopup.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport './LoginPopup.css';\r\nimport { loginUser } from '../../api';\r\n\r\nconst LoginPopup = ({ onClose, onSwitchToRegister }) => {\r\n  const popupRef = useRef(null);\r\n  const [formData, setFormData] = useState({\r\n    username: '',\r\n    password: ''\r\n  });\r\n  const [errors, setErrors] = useState({});\r\n  const [loading, setLoading] = useState(false);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (popupRef.current && !popupRef.current.contains(event.target)) {\r\n        onClose();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('mousedown', handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside);\r\n    };\r\n  }, [onClose]);\r\n\r\n  const handleChange = (event) => {\r\n    const { name, value } = event.target;\r\n    setFormData({ ...formData, [name]: value });\r\n    setErrors(prevErrors => ({ ...prevErrors, [name]: '' }));\r\n  };\r\n\r\n  const validateForm = () => {\r\n    const newErrors = {};\r\n    if (!formData.username.trim()) {\r\n      newErrors.username = 'Username is required';\r\n    }\r\n    if (!formData.password) {\r\n      newErrors.password = 'Password is required';\r\n    }\r\n    setErrors(newErrors);\r\n    return Object.keys(newErrors).length === 0;\r\n  };\r\n\r\n  const handleSubmit = async (event) => {\r\n    event.preventDefault();\r\n    if (!validateForm()) return;\r\n  \r\n    setLoading(true);\r\n    try {\r\n      const userData = await loginUser(formData); // Assuming loginUser returns JSON data directly\r\n      if (userData.token && userData.username) {\r\n        localStorage.setItem('token', userData.token);\r\n        localStorage.setItem('username', userData.username);\r\n        alert(`Welcome, ${userData.username}!`);\r\n        onClose();\r\n        navigate('/welcome');\r\n      } else {\r\n        setErrors({ general: 'Unexpected response format. Please try again.' });\r\n      }\r\n    } catch (err) {\r\n      console.error('Login error:', err);\r\n      setErrors({ general: err.message || 'Login failed. Please check your username and password.' });\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"login-popup\">\r\n      <form ref={popupRef} className=\"login-popup-container\" onSubmit={handleSubmit}>\r\n        <div className=\"login-popup-inputs\">\r\n          <input\r\n            name=\"username\"\r\n            type=\"text\"\r\n            placeholder=\"Username\"\r\n            value={formData.username}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          {errors.username && <span className=\"error\">{errors.username}</span>}\r\n          <input\r\n            name=\"password\"\r\n            type=\"password\"\r\n            placeholder=\"Password\"\r\n            value={formData.password}\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          {errors.password && <span className=\"error\">{errors.password}</span>}\r\n        </div>\r\n        <button type=\"submit\" disabled={loading}>\r\n          {loading ? 'Logging in...' : 'Login'}\r\n        </button>\r\n\r\n        {errors.general && <p className=\"error\">{errors.general}</p>}\r\n\r\n        <div className=\"login-popup-condition\">\r\n          <input type=\"checkbox\" required />\r\n          <p>\r\n            By Continuing, I agree to the terms of use & privacy policy. <br />\r\n            If you don't have an account, <a href=\"#\" onClick={onSwitchToRegister}><b>Click Here</b></a> to Register.\r\n          </p>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default LoginPopup;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}